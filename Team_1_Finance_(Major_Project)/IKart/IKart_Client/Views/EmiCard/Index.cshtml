﻿@model IEnumerable<IKart_Shared.DTOs.Admin.EmiCardDto>

@{ ViewBag.Title = "Manage EMI Cards";

    Layout = "~/Views/Shared/_AdminLayout.cshtml"; }

<div class="container mt-5 d-flex flex-column min-vh-100">
    <div class="card shadow-sm border-0 flex-grow-1">
        <div class="card-header d-flex justify-content-between align-items-center">
            <h4 class="mb-0 heading-title">Manage EMI Cards</h4>

        </div>

        <div class="card-body">

            @if (TempData["Message"] != null)

            {
<div class="alert alert-success">@TempData["Message"]</div>}

            <table class="table table-bordered table-hover align-middle">
                <thead class="table-dark text-white">
                    <tr>
                        <th>Card ID</th>
                        <th>User Name</th>
                        <th>Email</th>
                        <th>Fee Paid</th>
                        <th>Fee Status</th>
                        <th>Approval Status</th>
                        <th class="text-center">Actions</th>
                    </tr>
                </thead>
                <tbody>

                    @foreach (var card in Model)

                    {
        <tr>
            <td>@card.CardId</td>
            <td>@card.UserName</td>
            <td>@card.Email</td>
            <td>₹@card.FeeAmount.ToString("N2")</td>
            <td>@card.FeeStatus</td>
            <td>
                <span class="badge rounded-pill text-white

                                    @(card.ApprovalStatus == "Approved" ? "bg-success" :

                                      card.ApprovalStatus == "Rejected" ? "bg-danger" :

                                      "text-bg-warning")">

                    @card.ApprovalStatus
                </span>
            </td>
            <td class="text-center">
                <div class="d-flex justify-content-center flex-wrap gap-2">

                    @using (Html.BeginForm("View", "EmiCard", new { id = card.CardId }, FormMethod.Get))

                    {
    <button type="submit" class="btn btn-outline-info btn-sm">
        <i class="fa fa-eye me-1"></i> View
    </button>}

                    @using (Html.BeginForm("UpdateStatus", "EmiCard", new { id = card.CardId, status = "Approved" }, FormMethod.Post))

                    {
    <button type="submit" class="btn btn-outline-success btn-sm">
        <i class="fa fa-check-circle me-1"></i> Approve
    </button>}

                    @using (Html.BeginForm("UpdateStatus", "EmiCard", new { id = card.CardId, status = "Rejected" }, FormMethod.Post))

                    {
    <button type="submit" class="btn btn-outline-danger btn-sm">
        <i class="fa fa-ban me-1"></i> Reject
    </button>}
                </div>
            </td>
        </tr>
}
                </tbody>
            </table>
        </div>
    </div>
</div>
